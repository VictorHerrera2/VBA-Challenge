Sub stocks()For Each ws In Worksheets  'FIND LAST ROW  LastRow = ws.Cells(Rows.Count, 2).End(xlUp).Row  ' CREATE VARIABLES FOR EACH VALUE----------------------------------  Dim Ticker As String  Dim volumeTotal As Double  volumeTotal = 0  Dim yearlyChange As Double  Dim openPrice As Double  Dim closePrice As Double  Dim percentChange As Double  Dim maxPercent As Double  Dim minPercent As Double  Dim maxVolume As Double  Dim maxVolumeTicker As Variant  Dim maxIncrs As Double  Dim minIncrs As Double  Dim maxIncrsTicker As Variant  Dim minIncrsTicker As Variant  ' TRACK OF LOCATION  Dim Summary_Table_Row As Integer  Summary_Table_Row = 2  'PRINT HEADERS FOR REQUIRED COLUMNS-------------------------------  ws.Cells(1, 9).Value = "Ticker"  ws.Cells(1, 10).Value = "Yearly Change"  ws.Cells(1, 11).Value = "Percent Change"  ws.Cells(1, 12).Value = "Total stock volume"  ws.Cells(2, 15).Value = "Greatest % increase"  ws.Cells(3, 15).Value = "Greatest % decrease"  ws.Cells(4, 15).Value = "Greatest total volume"  ws.Cells(1, 17).Value = "Value"  ws.Cells(1, 16).Value = "Ticker"  'LOOP ALL THE ROWS-------------------------------------------------  For i = 2 To LastRow    ' CHECK IF WITHIN THE SAME TICKER, AND IF NOT, DO THE FOLLOWING    If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then          ' SET THE TICKER AND TOTAL VOLUME---------------------------------        Ticker = ws.Cells(i, 1).Value        volumeTotal = volumeTotal + ws.Cells(i, 7).Value      ' PRINT TICKER AND TOTAL VOLUME------------------------------------        ws.Range("I" & Summary_Table_Row).Value = Ticker        ws.Range("L" & Summary_Table_Row).Value = volumeTotal      'FIND AND PRINT THE YEARLY CHANGE----------------------------------        openPrice = ws.Cells(i, 3).Value        closePrice = ws.Cells(i, 6).Value        yearlyChange = closePrice - openPrice        ws.Range("J" & Summary_Table_Row).Value = yearlyChange      'FIND AND PRINT THE PERCENT CHANGE--------------------------------        percentChange = (openPrice - closePrice) / closePrice        ws.Range("K" & Summary_Table_Row).Value = percentChange        ws.Range("K" & Summary_Table_Row).NumberFormat = "0.00%"              'FIND GREATEST TOTAL VALUE AND TICKER-----------------------------------------------        maxVolume = WorksheetFunction.Max(ws.Range("L2:L" & LastRow).Value)        ws.Range("Q" & 4).Value = maxVolume        maxVolumeTicker = WorksheetFunction.Match(maxVolume, ws.Range("L2:L" & LastRow).Value, 0)        ws.Range("P" & 4) = ws.Cells(maxVolumeTicker, 9)      'FIND GREATEST INCREASE %  AND TICKER-------------------------------------------------        maxIncrs = WorksheetFunction.Max(ws.Range("K2:K" & LastRow).Value)        ws.Range("Q" & 2).Value = maxIncrs        maxIncrsTicker = WorksheetFunction.Match(maxIncrs, ws.Range("K2:K" & LastRow).Value, 0)        ws.Range("P" & 2) = ws.Cells(maxIncrsTicker, 9)        ws.Range("Q" & 2).NumberFormat = "0.00%"      'FIND GREATEST DECREASE %  AND TICKER-------------------------------------------------        minIncrs = WorksheetFunction.Min(ws.Range("K2:K" & LastRow).Value)        ws.Range("Q" & 3).Value = minIncrs        minIncrsTicker = WorksheetFunction.Match(minIncrs, ws.Range("K2:K" & LastRow).Value, 0)        ws.Range("P" & 3) = ws.Cells(minIncrsTicker, 9)        ws.Range("Q" & 3).NumberFormat = "0.00%"            ' ADD 1 TO THE LOCATION      Summary_Table_Row = Summary_Table_Row + 1      ' VOLUME RESET      volumeTotal = 0    Else      ' ADD VOLUME      volumeTotal = volumeTotal + ws.Cells(i, 7).Value    End If   Next i  Next wsEnd Sub